<%- include("../user/layout/header") %>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <!-- breadcrumb start-->

  <!--================ confirmation part start =================-->
 
    <div class="px-4 mt-3">
        
   <section class="">
    <div class="container">
      <div id="invoice" >
      <div class="row">
        <button type="button" id="download-button" class="btn btn-primary" >Download invoice</button>
        
        <div class=" card border-0 bg-secondary mb-3 px-2 col-lg-6 col-lx-4">
          <div class="m-3 single_confirmation_details">
            <h4>order info</h4>
            <ul>
                <li>
                  <p>order ID:  <%=order.id%></p>
                </li>
                <li>
                  <p>Date: <%=order.date%></p>
                </li>
                <li>
                  <p>Total: <%=order.total%></p>
                </li>
                <li>
                  <p>Payment Method:  <%=order.paymentMethod
                      %></p>
                </li>
                <li>
                  <p>Payment Status:  <%=order.paymentStatus%></p>
                </li>
                <li>
                  <p>Order Status:  <%=order.orderStatus%></p>
                </li>
              </ul>
          </div>
        </div>
        <div class=" card border-0 bg-secondary mb-3 col-lg-6 col-lx-4">
          <div class=" m-3 single_confirmation_details">
            <h4>Billing Address</h4>
            <ul>
                <li>
                  <p>Name:<%=order.address[0].name%></p>
                  <p>Mobile Number:<%=order.address[0].mobileNumber%> </p>
                  <p>Address:<%=order.address[0].address%></p>
                  <p>Locality:<%=order.address[0].locality%></p>
                  <p>City/Town/District:<%=order.address[0].cityDistrictTown%></p>
                  <p>LandMark:<%=order.address[0].landmark%></p>
                  <p>State:<%=order.address[0].state%></p>
                  <p>country:<%=order.address[0].country%></p>
                  <p>postcode:<%=order.address[0].pinCode%></p>
                </li>
              </ul>
          </div>
        </div>
        <!-- <div class=" card col-lg-6 col-lx-4">
          <div class="single_confirmation_details">
            <h4>shipping Address</h4>
            <ul>
              <li>
                <p>Street</p><span>: 56/8</span>
              </li>
              <li>
                <p>city</p><span>: Los Angeles</span>
              </li>
              <li>
                <p>country</p><span>: United States</span>
              </li>
              <li>
                <p>postcode</p><span>: 36952</span>
              </li>
            </ul>
          </div>
        </div> -->
      </div>
    
        
          <div class="card border-0 bg-secondary mb-3 order_details_iner">
            <div class="m-3">
            <h3>Order Details</h3>
            <table class="table table-borderless">
              <thead>
                <tr>
                  <th scope="col" colspan="2">Product</th>
                  <th scope="col">Quantity</th>
                  <th scope="col">Total</th>
                </tr>
              </thead>
              <tbody>
                <% for(var i=0; i<order.products.length; i++) { %>
                <tr>
                  <th colspan="2"><span><%=order.products[i].product.title%></span></th>
                  <th>x<%=order.products[i].quantity%></th>
                  <th> <span>$<%=order.products[i].total%></span></th>
                </tr>
                <%}%>
              
             
                <tr>
                  <th colspan="3">Subtotal</th>
                  <th> <span>$<%=order.total%></span></th>
                </tr>
                <tr>
                  <th colspan="3">shipping</th>
                  <%if(order.paymentMethod=='through wallet'){%>
                  <th><span>deducted from wallet <%=order.deductwallet%></span></th>
                <%}%>
                </tr>
           
              </tbody>
              <tfoot>
                <tr>
                  <th scope="col" colspan="3"></th> 
                  <th scope="col">Total:$<%=order.total%></th>
                </tr>
              </tfoot>
            </table>                             
          </div>               
      
          
          </div>
      </div>
        <div class="d-flex justify-content-center">
          <%if(order.paymentStatus=='payment pending'&&order.paymentMethod=='razorpay'){%>
            <a href="/refund/<%=order._id%>"><button class="btn btn-primary py-2 px-4 mr-3" type="submit" id="sendMessageButton">payment</button></a>
          <%}else if((order.orderStatus=='Returned')|| (order.orderStatus=='Cancelled'&&order.paymentStatus=='Payment Completed')){%>
            <a href="/refund/<%=order._id%>"><button class="btn btn-primary py-2 px-4 mr-3" type="submit" id="sendMessageButton">Request to refund</button></a>
            <%}else if(order.orderStatus=='Delivered'&&order.paymentStatus=='Payment Completed'){%>
        <a href="/productReturn/<%=order._id%>"><button class="btn btn-primary py-2 px-4 mr-3" type="submit" id="sendMessageButton">Product Return</button></a>
        <%}else if(order.orderStatus=='payment Refunded') {%>

          <%}else if(order.orderStatus=='Order Placed'||order.orderStatus=='order confirmed'){%>
          <a href="/cancelOrder/<%=order._id%>"><button class="btn btn-primary py-2 px-4 mr-3" type="submit" id="sendMessageButton">cancle Order</button></a>
          <%}%>
          <a href="/"><button class="btn btn-primary py-2 px-4" type="submit" id="sendMessageButton">Continue shopping </button></a>
     </div>
        </div>
    </div>
   
 
    </div>



    
<script>

  const button = document.getElementById('download-button');
  
  
  function generatePDF() {
    // Choose the element that your content will be rendered to.
    const element = document.getElementById('invoice');
    // Choose the element and save the PDF for your user.
    html2pdf().from(element).save();
  }
  
  button.addEventListener('click', generatePDF);
  
  
  </script>
 
    <%-include("../user/layout/footer")%>
  <!--================ confirmation part end =================-->
